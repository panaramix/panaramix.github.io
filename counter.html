<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Числа</title>

</head>
<body>
    <div id="numbers" class="numbers">
      <div id="numArray"  class="debug"></div>
      <div id="sumArray" class="debug"></div>
      <h1 id="counter"></h1>
    </div>

    <div id="param" class="param">

      <div class="field">
        <label for="digits">Количество разрядов</label>
        <input type="text" id="digits" value="2">
      </div>

      <div class="field">
        <label for="amount">Количество чисел</label>
        <input type="text" id="amount" value="10">
      </div>

      <div class="field">
        <label for="interval">Интервал, мс</label>
        <input type="text" id="interval" value="2000">
      </div>

      <div class="field">
        <label for="negative">Отрицательные числа</label>
        <input type="checkbox" id="negative">
      </div>

      <div class="field" title="Без переноса в старший разряд">
        <label for="nocarryover">Упрощенный режим</label>
        <input type="checkbox" id="nocarryover">
      </div>

        <input type="button" value="Начать" onClick="startCount()"/>
    </div>



    <script type="text/javascript">

      var numArray = document.getElementById("numArray");
      var sumArray = document.getElementById("sumArray");
      var counter = document.getElementById('counter');
      var param = document.getElementById('param');
      var numbers = document.getElementById('numbers');

      function startCount() {

        var digits =  parseInt(document.getElementById("digits").value, 10);
        var amount = parseInt(document.getElementById("amount").value, 10);
        var interval = parseInt(document.getElementById("interval").value, 10);
        var negative = document.getElementById("negative").checked;
        var nocarryover = document.getElementById("nocarryover").checked;

        var arr = [];
        var sumArr = [];
        var max = Math.pow(10, digits) - 1;
        var min = negative ? -max : 1;
        var lastNum = 0;
        var interimSum = 0;

        for (var i = 0; i < amount; i ++) {
          if (nocarryover) {
            var randomNum = randomIntegerNoCarryOver(digits, interimSum);
          } else {
            var randomNum = randomInteger(min, max);
          }
          if (randomNum == 0 || randomNum == lastNum) {
            i --;
            continue;
          }
          arr.push(randomNum);
          lastNum = randomNum;
          interimSum += randomNum;
          sumArr.push(interimSum);
        }
        //numArray.innerHTML = arr;
        //sumArray.innerHTML = sumArr;
        numbers.classList.toggle('show');
        param.classList.toggle('hide');

        counter.innerHTML = arr[0];
        var j = 0;
        var intervalId = setInterval(function () {
          if (++ j < arr.length) {
            counter.innerHTML = arr[j];
          }
        }, interval);

        setTimeout(function () {
          clearInterval(intervalId);
          numbers.classList.toggle('show');
          param.classList.toggle('hide');
        }, amount * interval);
      };

      function randomInteger(min, max) {
        var rand = min + Math.random() * (max + 1 - min);
        rand = Math.floor(rand);
        return rand;
      };

      function randomIntegerNoCarryOver(digits, interimSum) {

        if (interimSum == 0) {
          var max = Math.pow(10, digits) - 1;
          return randomInteger(1, max);
        }

        var randomArr = [];
        var divider =  Math.pow(10, digits - 1);
        var digit = Math.floor(interimSum / divider);
        var randomHighDigit = randomInteger(0, 9) - digit;
        randomArr.push(randomHighDigit);
        interimSum -= digit * divider;

        for (var i = divider / 10; i >= 1; i /= 10) {
          digit = Math.floor(interimSum / i);
          if (randomHighDigit >= 0) {
            randomArr.push(randomInteger(0, 9 - digit));
          } else {
            randomArr.push(randomInteger(0, digit));
          }
          interimSum -= digit * i;
        }

        return +randomArr.join("");
      };
    </script>

    <style type="text/css">

        body {
          font-family: sans-serif;
          width:500px;
          height:auto;
          text-align: center;
          margin-left:auto;
          margin-right:auto;
        }

        .param {
            float:left;
        }

        .param.hide {
            display: none;
        }

        .numbers {
          display: none;
        }

        .numbers.show {
          display: block;
        }

        h1 {
          font-size: 1500%;
        }

        input[type="text"] {
            width: 40px;
        }

        .field {
            clear:both;
            text-align:right;
            line-height:25px;
        }

        label {
            float:left;
            padding-right:10px;
        }
    </style>

</body>
</html>
